<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POS Burger23</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    :root {
      --color-principal: #e6a12a;
      --color-fondo: #f5f5f5;
      --color-primario-claro: #fff5e6;
      --color-terciario: #cc8a25;
      --color-texto: #333;
      --color-fondo-oscuro: #2c2c2c;
      --sidebar-width: 250px;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--color-fondo);
      color: var(--color-texto);
      min-height: 100vh;
      display: flex;
    }
    
    /* SIDEBAR */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--color-fondo-oscuro);
      color: white;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      display: flex;
      flex-direction: column;
      padding-top: 20px;
    }
    
    .sidebar .tab {
      padding: 15px 25px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.3s;
      border-left: 4px solid transparent;
    }
    
    .sidebar .tab:hover {
      background: rgba(230, 161, 42, 0.2);
    }
    
    .sidebar .tab.active {
      background: rgba(230, 161, 42, 0.3);
      border-left: 4px solid var(--color-principal);
    }
    
    .sidebar .tab i {
      width: 24px;
      text-align: center;
      color: var(--color-principal);
    }
    
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 20px;
      width: calc(100% - var(--sidebar-width));
    }
    
    header {
      background: var(--color-fondo-oscuro);
      color: #fff;
      padding: 15px 20px;
      border-bottom: 3px solid var(--color-principal);
      margin-bottom: 20px;
      border-radius: 0 0 10px 10px;
    }
    
    /* NUEVO ESTILO PARA EL LOGO CON HAMBURGUESA */
    .logo-container {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px 0;
    }
    
    .logo {
      font-size: 2.8rem;
      color: var(--color-principal);
    }
    
    .title-container {
      display: flex;
      flex-direction: column;
    }
    
    .title-container h1 {
      font-size: 2.5rem;
      color: var(--color-principal);
      margin: 0;
      letter-spacing: 1px;
      font-weight: 800;
    }
    
    .title-container p {
      color: #bbb;
      font-size: 1rem;
      margin-top: 5px;
    }
    
    .tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      background: #e0e0e0;
      padding: 10px;
      border-radius: 8px;
    }
    
    .tab {
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 4px;
      background: #d0d0d0;
      color: #555;
      font-weight: 600;
      transition: all 0.3s;
      border: none;
      font-size: 0.9rem;
      flex: 1;
      text-align: center;
    }
    
    .tab:hover {
      background: #c0c0c0;
    }
    
    .tab.active {
      background: var(--color-principal);
      color: #fff;
    }
    
    .content {
      display: none;
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .content.active {
      display: block;
    }
    
    .sub-content {
      display: none;
    }
    
    .sub-content.active {
      display: block;
    }
    
    /* MODAL DE OPCIONES */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .modal-content {
      background: white;
      border-radius: 8px;
      padding: 25px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .modal-header h3 {
      color: var(--color-principal);
      margin: 0;
    }
    
    .close-modal {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #777;
    }
    
    .option-group {
      margin-bottom: 20px;
    }
    
    .option-group h4 {
      margin-bottom: 10px;
      color: #555;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .option-label {
      flex: 1;
    }
    
    .option-control {
      display: flex;
      gap: 10px;
    }
    
    /* MENÚ PRINCIPAL */
    .menu-container {
      display: flex;
      gap: 20px;
      margin-top: 20px;
    }
    
    @media (max-width: 900px) {
      .menu-container {
        flex-direction: column;
      }
    }
    
    .menu-section {
      flex: 1;
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .menu-section h2 {
      color: var(--color-principal);
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--color-primario-claro);
    }
    
    .menu-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 15px;
    }
    
    .menu-item {
      display: flex;
      justify-content: space-between;
      padding: 12px 15px;
      background: #f9f9f9;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
      border-left: 3px solid var(--color-principal);
    }
    
    .menu-item:hover {
      background: var(--color-primario-claro);
      transform: translateX(5px);
    }
    
    .item-name {
      font-weight: 500;
    }
    
    .item-price {
      font-weight: bold;
      color: var(--color-terciario);
    }
    
    /* RESUMEN DEL PEDIDO */
    .preview {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      min-width: 300px;
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--color-primario-claro);
    }
    
    .preview-header h3 {
      color: var(--color-principal);
    }
    
    #itemsCount {
      background: var(--color-principal);
      color: white;
      padding: 3px 8px;
      border-radius: 20px;
      font-size: 0.8rem;
    }
    
    .empty-preview {
      text-align: center;
      color: #888;
      padding: 30px;
      font-style: italic;
    }
    
    #previewList {
      list-style: none;
      margin: 15px 0;
      max-height: 300px;
      overflow-y: auto;
    }
    
    #previewList li {
      padding: 10px 0;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    #previewTotal {
      font-weight: bold;
      font-size: 1.3em;
      text-align: right;
      padding: 10px 0;
      color: var(--color-principal);
      border-top: 2px solid #eee;
      margin-top: 10px;
    }
    
    .order-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 20px;
    }
    
    .order-form input, 
    .order-form select {
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }
    
    .add-btn {
      background: var(--color-terciario);
      color: #fff;
      border: none;
      padding: 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 10px;
    }
    
    .add-btn:hover {
      background: #b3781f;
      transform: translateY(-2px);
    }
    
    /* PEDIDOS EN PROCESO */
    .orders-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .order-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-left: 4px solid var(--color-principal);
    }
    
    .order-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .order-products div {
      padding: 8px 0;
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #f5f5f5;
    }
    
    .order-total {
      border-top: 1px solid #eee;
      padding-top: 15px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
    }
    
    .order-info {
      margin-top: 15px;
      font-size: 0.9em;
      color: #666;
    }
    
    .order-action-btn {
      background: var(--color-principal);
      color: white;
      border: none;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
      margin-top: 15px;
      transition: all 0.3s;
    }
    
    .order-action-btn:hover {
      background: #d18e22;
    }
    
    /* GESTIÓN DE PRODUCTOS */
    .gestion-container {
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    
    .gestion-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--color-primario-claro);
    }
    
    .gestion-header h2 {
      color: var(--color-principal);
    }
    
    .add-product-section {
      background: var(--color-primario-claro);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }
    
    .add-product-section h3 {
      margin-top: 0;
      color: var(--color-principal);
      margin-bottom: 15px;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr auto auto;
      gap: 15px;
      align-items: center;
    }
    
    .form-grid input, .form-grid select {
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }
    
    .price-control {
      display: flex;
      align-items: center;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    
    .price-btn {
      background: #f5f5f5;
      border: none;
      padding: 0 15px;
      height: 100%;
      cursor: pointer;
      font-size: 1.2rem;
      color: #555;
      transition: background 0.2s;
    }
    
    .price-btn:hover {
      background: #e0e0e0;
    }
    
    .price-input {
      border: none;
      width: 100px;
      padding: 12px;
      text-align: center;
      font-size: 1rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    th, td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    th {
      background: var(--color-primario-claro);
      color: var(--color-principal);
      font-weight: 600;
    }
    
    tr:hover {
      background-color: rgba(230, 161, 42, 0.05);
    }
    
    .input-inline {
      width: 100px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }
    
    .price-control-cell {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .small-btn {
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 4px;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .small-btn:hover {
      background: #e0e0e0;
    }
    
    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }
    
    .remove-btn:hover {
      background: #c0392b;
    }
    
    /* CONTROL DE CAJA */
    .caja-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .caja-section {
      background: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      border-left: 4px solid var(--color-principal);
    }
    
    .caja-section h3 {
      color: var(--color-principal);
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #eee;
    }
    
    #totalEfectivo, #totalCaja, #totalVentas, #totalMercadoPago {
      font-size: 1.8em;
      font-weight: bold;
      text-align: center;
      color: #27ae60;
      margin: 10px 0;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    #gastosList {
      max-height: 200px;
      overflow-y: auto;
      margin: 15px 0;
      flex: 1;
    }
    
    .gasto-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }
    
    .form-gasto {
      display: grid;
      grid-template-columns: 1fr 1fr auto;
      gap: 10px;
      margin-top: 15px;
    }
    
    .form-gasto input {
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    
    .close-day {
      background: #27ae60;
      color: white;
      padding: 14px 30px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1.1rem;
      margin-top: 20px;
      display: block;
      margin-left: auto;
      font-weight: 600;
      transition: background 0.3s;
    }
    
    .close-day:hover {
      background: #219653;
    }
    
    /* ESTILOS DE SCROLL */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    
    .success-message {
      background: #2ecc71;
      color: white;
      padding: 10px;
      border-radius: 4px;
      text-align: center;
      margin-top: 15px;
      display: none;
    }
    
    .delete-item-btn {
      background: transparent;
      border: none;
      color: #e74c3c;
      cursor: pointer;
      margin-left: 10px;
    }
    
    .delete-preview-item {
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      margin-left: 8px;
      font-size: 0.8rem;
    }
  </style>
</head>
<body>
  <!-- MODAL DE OPCIONES -->
  <div class="modal" id="optionsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalProductName"></h3>
        <button class="close-modal">&times;</button>
      </div>
      <div class="option-group">
        <h4>Tamaño</h4>
        <div class="option-row">
          <div class="option-label">Simple</div>
          <div class="option-control">
            <input type="radio" name="size" id="sizeSimple" value="simple" checked>
          </div>
        </div>
        <div class="option-row">
          <div class="option-label">Doble (+$1200)</div>
          <div class="option-control">
            <input type="radio" name="size" id="sizeDoble" value="doble">
          </div>
        </div>
      </div>
      
      <div class="option-group">
        <h4>Adicionales</h4>
        <div class="option-row">
          <div class="option-label">Cheddar (+$2000)</div>
          <div class="option-control">
            <input type="checkbox" id="extraCheddar">
          </div>
        </div>
        <div class="option-row">
          <div class="option-label">Panceta (+$2000)</div>
          <div class="option-control">
            <input type="checkbox" id="extraPanceta">
          </div>
        </div>
        <div class="option-row">
          <div class="option-label">Carne extra (+$2500)</div>
          <div class="option-control">
            <input type="checkbox" id="extraCarne">
          </div>
        </div>
      </div>
      
      <button class="add-btn" id="addToOrderModal"><i class="fas fa-plus"></i> Agregar al Pedido</button>
    </div>
  </div>
  
  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="tab active" data-target="menu-principal">
      <i class="fas fa-hamburger"></i>
      <span>Menú Principal</span>
    </div>
    <div class="tab" data-target="gestion-productos">
      <i class="fas fa-boxes"></i>
      <span>Productos</span>
    </div>
    <div class="tab" data-target="control-caja">
      <i class="fas fa-cash-register"></i>
      <span>Caja</span>
    </div>
  </div>
  
  <!-- CONTENIDO PRINCIPAL -->
  <div class="main-content">
    <!-- NUEVO HEADER CON HAMBURGUESA A LA IZQUIERDA -->
    <header>
      <div class="logo-container">
        <div class="logo">
          <i class="fas fa-hamburger"></i>
        </div>
        <div class="title-container">
          <h1>BURGER23</h1>
          <p>Sistema de gestión de pedidos</p>
        </div>
      </div>
    </header>
    
    <!-- MENÚ PRINCIPAL -->
    <div id="menu-principal" class="content active">
      <div class="tabs">
        <div class="tab active" data-sub="menu">Menú</div>
        <div class="tab" data-sub="cocina">En Cocina</div>
        <div class="tab" data-sub="camino">En Camino</div>
        <div class="tab" data-sub="entregados">Entregados</div>
      </div>
      
      <!-- SECCIÓN DE MENÚ -->
      <div id="menu" class="sub-content active">
        <div class="menu-container">
          <div class="menu-section">
            <h2><i class="fas fa-burger"></i> Nuestras Hamburguesas</h2>
            <div class="menu-list" id="productosList"></div>
          </div>
          
          <div class="menu-section preview">
            <div class="preview-header">
              <h3><i class="fas fa-receipt"></i> Resumen del Pedido</h3>
              <span id="itemsCount">0 items</span>
            </div>
            
            <div id="previewContainer">
              <div class="empty-preview">No hay productos en el pedido</div>
              <ul id="previewList" style="display: none;"></ul>
            </div>
            
            <p id="previewTotal" style="display: none;">Total: $0</p>
            
            <div class="order-form">
              <input type="text" id="dir" placeholder="Dirección de entrega">
              <select id="mpago">
                <option value="efectivo">Efectivo</option>
                <option value="mercadopago">MercadoPago</option>
              </select>
              <button class="add-btn" id="finalizar"><i class="fas fa-check-circle"></i> Confirmar Pedido</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- EN COCINA -->
      <div id="cocina" class="sub-content">
        <h2><i class="fas fa-utensils"></i> Pedidos en Cocina</h2>
        <div class="orders-container" id="cocinaList"></div>
      </div>
      
      <!-- EN CAMINO -->
      <div id="camino" class="sub-content">
        <h2><i class="fas fa-motorcycle"></i> Pedidos en Camino</h2>
        <div class="orders-container" id="caminoList"></div>
      </div>
      
      <!-- ENTREGADOS -->
      <div id="entregados" class="sub-content">
        <h2><i class="fas fa-check-circle"></i> Pedidos Entregados</h2>
        <div class="orders-container" id="entregadosList"></div>
      </div>
    </div>
    
    <!-- GESTIÓN DE PRODUCTOS -->
    <div id="gestion-productos" class="content">
      <div class="gestion-container">
        <div class="gestion-header">
          <h2><i class="fas fa-box-open"></i> Gestión de Productos</h2>
          <div class="add-product-info">
            <i class="fas fa-info-circle"></i> Agrega, edita y elimina productos
          </div>
        </div>
        
        <div class="add-product-section">
          <h3><i class="fas fa-plus-circle"></i> Agregar Nuevo Producto</h3>
          <div class="form-grid">
            <input id="newName" placeholder="Nombre del producto">
            <select id="newTipo">
              <option value="hamburguesas">Hamburguesa</option>
            </select>
            <div class="price-control">
              <button class="price-btn" id="decreasePrice">-</button>
              <input id="newPrice" type="number" value="5000" class="price-input" min="0" step="500">
              <button class="price-btn" id="increasePrice">+</button>
            </div>
            <button class="add-btn" id="addProd"><i class="fas fa-plus"></i> Agregar</button>
          </div>
        </div>
        
        <h3><i class="fas fa-list"></i> Lista de Productos</h3>
        <table>
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Tipo</th>
              <th>Precio</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="prodBody"></tbody>
        </table>
      </div>
    </div>
    
    <!-- CONTROL DE CAJA -->
    <div id="control-caja" class="content">
      <h2><i class="fas fa-cash-register"></i> Control de Caja</h2>
      
      <div class="caja-container">
        <div class="caja-section">
          <h3>Total en Efectivo</h3>
          <p id="totalEfectivo">$0</p>
        </div>
        
        <div class="caja-section">
          <h3>Gastos</h3>
          <div id="gastosList"></div>
          <div class="form-gasto">
            <input type="text" id="gastoDesc" placeholder="Descripción">
            <input type="number" id="gastoMonto" placeholder="Monto">
            <button class="add-btn" id="addGasto"><i class="fas fa-plus"></i></button>
          </div>
        </div>
        
        <div class="caja-section">
          <h3>Total Caja</h3>
          <p id="totalCaja">$0</p>
        </div>
        
        <div class="caja-section">
          <h3>Total de Ventas</h3>
          <p id="totalVentas">$0</p>
        </div>
        
        <div class="caja-section">
          <h3>Total en MercadoPago</h3>
          <p id="totalMercadoPago">$0</p>
        </div>
      </div>
      
      <button class="close-day" id="closeDay"><i class="fas fa-file-excel"></i> Cerrar Día y Exportar Excel</button>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Menú de hamburguesas
      var productos = [
        { id: 1, nombre: "American Classic", tipo: "hamburguesas", precio: 8500 },
        { id: 2, nombre: "American Blog", tipo: "hamburguesas", precio: 8600 },
        { id: 3, nombre: "Oklahoma", tipo: "hamburguesas", precio: 8600 },
        { id: 4, nombre: "Jordan", tipo: "hamburguesas", precio: 8500 },
        { id: 5, nombre: "Menú 23", tipo: "hamburguesas", precio: 8500 },
        { id: 6, nombre: "Cheeseburger", tipo: "hamburguesas", precio: 8500 },
        { id: 7, nombre: "Diegote", tipo: "hamburguesas", precio: 8500 },
        { id: 8, nombre: "Cuarto de Mila", tipo: "hamburguesas", precio: 8500 },
        { id: 9, nombre: "La Vilancio", tipo: "hamburguesas", precio: 8500 },
        { id: 10, nombre: "Solo Carne", tipo: "hamburguesas", precio: 7000 }
      ];

      // Precios de adicionales
      var adicionales = {
        doble: 1200,
        cheddar: 2000,
        panceta: 2000,
        carne: 2500
      };

      var pedidos = [], pid = 1, currentOrder = [];
      var gastos = [];
      var currentProduct = null;

      // Almacenamiento temporal en localStorage
      function guardarDatosTemporales() {
        var datosDia = {
          productos: productos,
          pedidos: pedidos,
          pid: pid,
          gastos: gastos
        };
        localStorage.setItem('datosDia', JSON.stringify(datosDia));
      }

      // Cargar datos al iniciar (si existen)
      function cargarDatosTemporales() {
        var datosGuardados = localStorage.getItem('datosDia');
        return datosGuardados ? JSON.parse(datosGuardados) : null;
      }

      // Función "Cerrar día"
      function cerrarDia() {
        var ent = pedidos.filter(function(o) { return o.estado === 'entregados'; });
        if(ent.length === 0) {
          alert('No hay pedidos entregados hoy');
          return;
        }

        // Prepare data for Excel
        var data = ent.map(function(order) {
          var items = order.items.map(function(item) { return item.desc; }).join('; ');
          var total = order.items.reduce(function(s, i) { return s + i.precio; }, 0);
          
          return {
            'ID Pedido': order.id,
            'Dirección': order.dir,
            'Método de Pago': order.pago === 'efectivo' ? 'Efectivo' : 'MercadoPago',
            'Productos': items,
            'Total': total,
            'Hora': order.hora,
            'Fecha': new Date().toLocaleDateString('es-ES')
          };
        });

        // Create worksheet
        var ws = XLSX.utils.json_to_sheet(data);

        // Create workbook
        var wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Pedidos");

        // Generate file and download
        var dateStr = new Date().toISOString().slice(0, 10);
        XLSX.writeFile(wb, 'Pedidos_Burger23_' + dateStr + '.xlsx');

        alert('Se ha generado el archivo Excel con ' + ent.length + ' pedidos');
        
        // Borrar solo los pedidos entregados
        pedidos = pedidos.filter(p => p.estado !== 'entregados');
        
        // Actualizar UI
        renderSubLists();
        renderCaja();
        guardarDatosTemporales();
      }

      // Cargar datos iniciales
      var datosIniciales = cargarDatosTemporales();
      if (datosIniciales) {
        productos = datosIniciales.productos || productos;
        pedidos = datosIniciales.pedidos || [];
        pid = datosIniciales.pid || pid;
        gastos = datosIniciales.gastos || [];
      }

      // Renderizar productos en lista simple
      function renderProductos() {
        var container = document.getElementById('productosList');
        container.innerHTML = '';
        
        productos.forEach(function(p) {
          var item = document.createElement('div');
          item.className = 'menu-item';
          item.innerHTML = `
            <div class="item-name">${p.nombre}</div>
            <div class="item-price">$${p.precio}</div>
          `;
          
          item.addEventListener('click', function() {
            showOptionsModal(p);
          });
          
          container.appendChild(item);
        });
      }
      
      // Mostrar modal de opciones
      function showOptionsModal(product) {
        currentProduct = product;
        document.getElementById('modalProductName').textContent = product.nombre;
        document.getElementById('optionsModal').style.display = 'flex';
      }
      
      // Cerrar modal
      document.querySelector('.close-modal').addEventListener('click', function() {
        document.getElementById('optionsModal').style.display = 'none';
      });
      
      // Agregar al pedido desde el modal
      document.getElementById('addToOrderModal').addEventListener('click', function() {
        if (!currentProduct) return;
        
        // Calcular precio base
        var precio = currentProduct.precio;
        var desc = currentProduct.nombre;
        
        // Verificar tamaño
        var size = document.querySelector('input[name="size"]:checked').value;
        if (size === 'doble') {
          precio += adicionales.doble;
          desc += ' (Doble)';
        } else {
          desc += ' (Simple)';
        }
        
        // Verificar adicionales
        if (document.getElementById('extraCheddar').checked) {
          precio += adicionales.cheddar;
          desc += ' + Cheddar';
        }
        
        if (document.getElementById('extraPanceta').checked) {
          precio += adicionales.panceta;
          desc += ' + Panceta';
        }
        
        if (document.getElementById('extraCarne').checked) {
          precio += adicionales.carne;
          desc += ' + Carne extra';
        }
        
        // Agregar al pedido
        var hora = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        currentOrder.push({
          desc: desc, 
          precio: precio, 
          hora: hora
        });
        
        // Actualizar resumen y cerrar modal
        actualizarResumen();
        document.getElementById('optionsModal').style.display = 'none';
        
        // Resetear opciones
        document.getElementById('sizeSimple').checked = true;
        document.getElementById('extraCheddar').checked = false;
        document.getElementById('extraPanceta').checked = false;
        document.getElementById('extraCarne').checked = false;
      });
      
      // Actualizar resumen del pedido
      function actualizarResumen() {
        var list = document.getElementById('previewList');
        list.innerHTML = '';
        var sum = 0;
        
        if(currentOrder.length === 0) {
          document.querySelector('#previewContainer .empty-preview').style.display = 'block';
          list.style.display = 'none';
          document.getElementById('previewTotal').style.display = 'none';
        } else {
          document.querySelector('#previewContainer .empty-preview').style.display = 'none';
          list.style.display = 'block';
          document.getElementById('previewTotal').style.display = 'block';
          
          currentOrder.forEach(function(item, index) {
            list.innerHTML += `
              <li>
                <span>${item.desc}</span>
                <span>
                  $${item.precio} 
                  <span style="font-size:0.8em; color:#888;">(${item.hora})</span>
                  <button class="delete-preview-item" data-index="${index}">
                    <i class="fas fa-trash"></i>
                  </button>
                </span>
              </li>
            `;
            sum += item.precio;
          });
        }
        
        document.getElementById('previewTotal').innerText = 'Total: $' + sum;
        document.getElementById('itemsCount').innerText = currentOrder.length + ' ' + (currentOrder.length === 1 ? 'item' : 'items');
      }
      
      // Finalizar pedido
      document.getElementById('finalizar').addEventListener('click', function() {
        var dir = document.getElementById('dir').value;
        var pago = document.getElementById('mpago').value;
        
        if(!dir || currentOrder.length === 0) {
          alert('Por favor ingrese una dirección y agregue productos al pedido');
          return;
        }
        
        pedidos.push({
          id: pid++,
          items: currentOrder.slice(),
          dir: dir,
          pago: pago,
          estado: 'cocina',
          hora: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
        });
        
        // Imprimir ticket directamente
        imprimirTicket(pedidos[pedidos.length - 1]);
        
        currentOrder = [];
        actualizarResumen();
        renderSubLists();
        renderCaja();
        
        document.getElementById('dir').value = '';
        
        // Guardar en localStorage
        guardarDatosTemporales();
      });
      
      // Imprimir ticket (NUEVO DISEÑO)
      function imprimirTicket(order) {
        // Crear contenido del ticket con el nuevo diseño
        var ticketContent = `
          <html>
            <head>
              <title>Ticket Burger23</title>
              <style>
                body { 
                  font-family: Arial, sans-serif; 
                  padding: 20px; 
                  max-width: 300px; 
                  margin: 0 auto; 
                  background-color: #fff;
                }
                .header { 
                  text-align: center; 
                  margin-bottom: 15px; 
                }
                .header h1 { 
                  font-size: 28px; 
                  margin: 0; 
                  color: #000;
                  font-weight: 800;
                  letter-spacing: 1px;
                }
                .section { 
                  margin: 15px 0; 
                }
                .section-title {
                  font-weight: bold;
                  margin-top: 10px;
                  text-align: center;
                  text-transform: uppercase;
                  font-size: 18px;
                  padding-bottom: 5px;
                  border-bottom: 1px dashed #000;
                }
                .section-content {
                  margin-top: 10px;
                  text-align: center;
                  font-size: 16px;
                }
                .detail-item {
                  display: flex;
                  justify-content: space-between;
                  margin-bottom: 5px;
                  padding: 3px 0;
                }
                .total {
                  font-weight: bold;
                  font-size: 20px;
                  text-align: center;
                  margin: 20px 0;
                  padding-top: 10px;
                  border-top: 1px dashed #000;
                }
                .footer { 
                  text-align: center; 
                  margin-top: 30px; 
                  font-size: 14px;
                  font-weight: bold;
                }
                .divider {
                  border-top: 1px dashed #000;
                  margin: 15px 0;
                }
              </style>
            </head>
            <body>
              <div class="header">
                <h1>BURGER 23</h1>
              </div>
              
              <div class="divider"></div>

              <div class="section">
                <div class="section-title">Dirección de entrega</div>
                <div class="section-content">${order.dir}</div>
              </div>
              
              <div class="divider"></div>

              <div class="section">
                <div class="section-title">Detalle</div>
                <div class="section-content">
                  ${order.items.map(item => `
                    <div class="detail-item">
                      <div>${item.desc}</div>
                      <div>$${item.precio.toFixed(2)}</div>
                    </div>
                  `).join('')}
                </div>
              </div>
              
              <div class="divider"></div>

              <div class="section">
                <div class="section-title">Total</div>
                <div class="total">
                  $${order.items.reduce((sum, item) => sum + item.precio, 0).toFixed(2)}
                </div>
              </div>
              
              <div class="footer">
                <div>GRACIAS POR SU COMPRA</div>
                <div>${new Date().toLocaleString()}</div>
              </div>
            </body>
          </html>
        `;
        
        // Crear ventana de impresión
        var printWindow = window.open('', '_blank');
        printWindow.document.write(ticketContent);
        printWindow.document.close();
        
        // Imprimir y cerrar
        printWindow.onload = function() {
          printWindow.print();
          setTimeout(function() { 
            printWindow.close(); 
          }, 500);
        };
      }
      
      // Renderizar pedidos por estado - CORRECCIÓN APLICADA
      function renderSubLists() {
        // Estados corregidos para coincidir con los IDs del HTML
        ['cocina', 'camino', 'entregados'].forEach(function(estado) {
          var containerId = estado + 'List';
          var container = document.getElementById(containerId);
          if (!container) return;
          
          container.innerHTML = '';
          
          var orders = pedidos.filter(function(o) { 
            return o.estado === estado; 
          });
          
          if (orders.length === 0) {
            container.innerHTML = `
              <div style="text-align:center; padding:30px; color:#888; background:white; border-radius:8px;">
                <i class="fas fa-inbox" style="font-size:3em; margin-bottom:15px;"></i>
                <p>No hay pedidos en esta categoría</p>
              </div>
            `;
            return;
          }
          
          orders.forEach(function(o) {
            var card = document.createElement('div');
            card.className = 'order-card';
            
            var total = o.items.reduce(function(sum, item) { 
              return sum + item.precio; 
            }, 0);
            
            var itemsHTML = o.items.map(function(it, itemIndex) {
              var deleteButton = '';
              if (o.estado === 'cocina') {
                deleteButton = `<button class="delete-item-btn" data-orderid="${o.id}" data-itemindex="${itemIndex}"><i class="fas fa-trash"></i></button>`;
              }
              return `
                <div>
                  <span>${it.desc} ${deleteButton}</span>
                  <span>$${it.precio}</span>
                </div>
              `;
            }).join('');
            
            card.innerHTML = `
              <div class="order-header">
                <div style="font-weight: bold; color: var(--color-principal);">#${o.id}</div>
                <div class="order-time" style="color:#666;">${o.hora}</div>
              </div>
              <div class="order-products">${itemsHTML}</div>
              <div class="order-total">
                <span>Total:</span>
                <span>$${total}</span>
              </div>
              <div class="order-info">
                <div><strong>Dirección:</strong> ${o.dir}</div>
                <div><strong>Pago:</strong> ${o.pago === 'efectivo' ? 'Efectivo' : 'MercadoPago'}</div>
              </div>
            `;
            
            if (estado !== 'entregados') {
              var btn = document.createElement('button');
              btn.className = 'order-action-btn';
              btn.innerHTML = estado === 'cocina' 
                ? '<i class="fas fa-motorcycle"></i> Enviar a Entrega' 
                : '<i class="fas fa-check-circle"></i> Marcar como Entregado';
              
              // Corrección en la transición de estados
              btn.addEventListener('click', function() {
                o.estado = estado === 'cocina' ? 'camino' : 'entregados';
                renderSubLists();
                renderCaja();
                guardarDatosTemporales();
              });
              
              card.appendChild(btn);
            }
            
            container.appendChild(card);
          });
        });
        
        // Configurar eventos para eliminar items
        setupDeleteButtons();
      }
      
      // Configurar botones para eliminar items
      function setupDeleteButtons() {
        ['cocinaList', 'caminoList', 'entregadosList'].forEach(function(containerId) {
          var container = document.getElementById(containerId);
          if (container) {
            container.addEventListener('click', function(e) {
              if (e.target.classList.contains('delete-item-btn') || e.target.closest('.delete-item-btn')) {
                var btn = e.target.closest('.delete-item-btn');
                var orderId = parseInt(btn.dataset.orderid);
                var itemIndex = parseInt(btn.dataset.itemindex);
                
                // Encontrar el pedido
                var order = pedidos.find(o => o.id === orderId);
                if (order) {
                  // Eliminar el item
                  order.items.splice(itemIndex, 1);
                  
                  // Si no quedan items, eliminar el pedido
                  if (order.items.length === 0) {
                    pedidos = pedidos.filter(o => o.id !== orderId);
                  }
                  
                  // Actualizar la UI
                  renderSubLists();
                  guardarDatosTemporales();
                }
              }
            });
          }
        });
      }
      
      // Renderizar gestión de productos
      function renderManagement() {
        var tbody = document.getElementById('prodBody');
        tbody.innerHTML = '';
        
        productos.forEach(function(p) {
          var tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${p.nombre}</td>
            <td>${p.tipo}</td>
            <td>
              <div class="price-control-cell">
                <button class="small-btn" data-id="${p.id}" data-action="decrease">-</button>
                <input type="number" value="${p.precio}" data-id="${p.id}" class="input-inline edit-price" min="0" step="500">
                <button class="small-btn" data-id="${p.id}" data-action="increase">+</button>
              </div>
            </td>
            <td>
              <button class="remove-btn" data-id="${p.id}">
                <i class="fas fa-trash"></i> Eliminar
              </button>
            </td>
          `;
          
          tbody.appendChild(tr);
          
          // Eventos para los botones de precio
          tr.querySelector('.edit-price').addEventListener('change', function() {
            var prod = productos.find(x => x.id == this.dataset.id);
            if(prod) {
              prod.precio = Number(this.value);
              renderProductos();
              guardarDatosTemporales();
            }
          });
          
          // Botón de incremento
          tr.querySelector('[data-action="increase"]').addEventListener('click', function() {
            var prod = productos.find(x => x.id == this.dataset.id);
            if(prod) {
              prod.precio += 500;
              var input = this.previousElementSibling;
              input.value = prod.precio;
              renderProductos();
              guardarDatosTemporales();
            }
          });
          
          // Botón de decremento
          tr.querySelector('[data-action="decrease"]').addEventListener('click', function() {
            var prod = productos.find(x => x.id == this.dataset.id);
            if(prod && prod.precio > 500) {
              prod.precio -= 500;
              var input = this.nextElementSibling;
              input.value = prod.precio;
              renderProductos();
              guardarDatosTemporales();
            }
          });
          
          // Botón de eliminar
          tr.querySelector('.remove-btn').addEventListener('click', function() {
            productos = productos.filter(x => x.id != this.dataset.id);
            renderManagement();
            renderProductos();
            guardarDatosTemporales();
          });
        });
      }
      
      // Agregar nuevo producto
      document.getElementById('addProd').addEventListener('click', function() {
        var n = document.getElementById('newName').value;
        var t = document.getElementById('newTipo').value;
        var pr = Number(document.getElementById('newPrice').value);
        
        if(!n || pr <= 0) {
          alert('Por favor ingrese un nombre y precio válido');
          return;
        }
        
        productos.push({
          id: Date.now(),
          nombre: n,
          tipo: t,
          precio: pr
        });
        
        renderManagement();
        renderProductos();
        guardarDatosTemporales();
        
        document.getElementById('newName').value = '';
        
        // Mostrar mensaje de éxito
        var successMsg = document.createElement('div');
        successMsg.className = 'success-message';
        successMsg.innerHTML = '<i class="fas fa-check-circle"></i> Producto agregado con éxito';
        this.parentElement.appendChild(successMsg);
        
        setTimeout(function() {
          successMsg.style.display = 'none';
        }, 3000);
      });
      
      // Botones para control de precio en nuevo producto
      document.getElementById('increasePrice').addEventListener('click', function() {
        var input = document.getElementById('newPrice');
        input.value = Number(input.value) + 500;
      });
      
      document.getElementById('decreasePrice').addEventListener('click', function() {
        var input = document.getElementById('newPrice');
        var value = Number(input.value);
        if(value > 500) {
          input.value = value - 500;
        }
      });
      
      // Renderizar control de caja
      function renderCaja() {
        // Calcular efectivo (solo pedidos finalizados en efectivo)
        var efectivo = pedidos
          .filter(function(o) { return o.estado === 'entregados' && o.pago === 'efectivo'; })
          .reduce(function(sum, o) { 
            return sum + o.items.reduce(function(s, i) { return s + i.precio; }, 0); 
          }, 0);
        
        // Calcular total gastos
        var totalGastos = gastos.reduce(function(sum, g) { return sum + g.monto; }, 0);
        
        // Calcular total caja
        var totalCaja = efectivo - totalGastos;
        
        // Calcular total de ventas (todos los pedidos entregados)
        var totalVentas = pedidos
          .filter(function(o) { return o.estado === 'entregados'; })
          .reduce(function(sum, o) { 
            return sum + o.items.reduce(function(s, i) { return s + i.precio; }, 0); 
          }, 0);
        
        // Calcular total en MercadoPago
        var totalMercadoPago = pedidos
          .filter(function(o) { return o.estado === 'entregados' && o.pago === 'mercadopago'; })
          .reduce(function(sum, o) { 
            return sum + o.items.reduce(function(s, i) { return s + i.precio; }, 0); 
          }, 0);
        
        // Actualizar UI
        document.getElementById('totalEfectivo').textContent = '$' + efectivo.toFixed(2);
        document.getElementById('totalCaja').textContent = '$' + totalCaja.toFixed(2);
        document.getElementById('totalVentas').textContent = '$' + totalVentas.toFixed(2);
        document.getElementById('totalMercadoPago').textContent = '$' + totalMercadoPago.toFixed(2);
        
        // Renderizar gastos
        var gastosList = document.getElementById('gastosList');
        gastosList.innerHTML = '';
        
        if (gastos.length === 0) {
          gastosList.innerHTML = '<p style="text-align:center; color:#888;">No hay gastos registrados</p>';
        } else {
          gastos.forEach(function(gasto, index) {
            var item = document.createElement('div');
            item.className = 'gasto-item';
            item.innerHTML = `
              <span>${gasto.desc}</span>
              <span>$${gasto.monto.toFixed(2)}</span>
              <button data-index="${index}"><i class="fas fa-trash"></i></button>
            `;
            
            item.querySelector('button').addEventListener('click', function() {
              gastos.splice(index, 1);
              renderCaja();
              guardarDatosTemporales();
            });
            
            gastosList.appendChild(item);
          });
        }
      }
      
      // Agregar gasto
      document.getElementById('addGasto').addEventListener('click', function() {
        var desc = document.getElementById('gastoDesc').value;
        var monto = parseFloat(document.getElementById('gastoMonto').value);
        
        if (!desc || isNaN(monto)) {
          alert('Por favor complete la descripción y el monto');
          return;
        }
        
        gastos.push({
          desc: desc,
          monto: monto,
          fecha: new Date().toLocaleString()
        });
        
        document.getElementById('gastoDesc').value = '';
        document.getElementById('gastoMonto').value = '';
        
        renderCaja();
        guardarDatosTemporales();
      });
      
      // Cerrar día y exportar Excel
      document.getElementById('closeDay').addEventListener('click', cerrarDia);
      
      // Navegación sidebar principal
      document.querySelectorAll('.sidebar .tab').forEach(function(tab) {
        tab.addEventListener('click', function() {
          // Actualizar pestañas activas
          document.querySelectorAll('.sidebar .tab').forEach(function(t) {
            t.classList.remove('active');
          });
          document.querySelectorAll('.content').forEach(function(c) {
            c.classList.remove('active');
          });
          
          // Activar pestaña seleccionada
          this.classList.add('active');
          var target = this.getAttribute('data-target');
          document.getElementById(target).classList.add('active');
          
          // Actualizar contenido según sea necesario
          if (target === 'menu-principal') {
            renderProductos();
            // Activar la subtab "Menú" por defecto
            document.querySelector('#menu-principal .tab[data-sub="menu"]').click();
          } else if (target === 'gestion-productos') {
            renderManagement();
          } else if (target === 'control-caja') {
            renderCaja();
          }
        });
      });
      
      // Navegación subtabs del menú principal
      document.querySelectorAll('#menu-principal .tab').forEach(function(tab) {
        tab.addEventListener('click', function() {
          // Actualizar subtabs activas
          document.querySelectorAll('#menu-principal .tab').forEach(function(t) {
            t.classList.remove('active');
          });
          document.querySelectorAll('#menu-principal .sub-content').forEach(function(c) {
            c.classList.remove('active');
          });
          
          // Activar subtab seleccionada
          this.classList.add('active');
          var subTarget = this.getAttribute('data-sub');
          document.getElementById(subTarget).classList.add('active');
          
          // Actualizar contenido
          if (subTarget === 'menu') {
            renderProductos();
          } else {
            renderSubLists();
          }
        });
      });
      
      // Evento para eliminar items en la vista previa
      document.getElementById('previewContainer').addEventListener('click', function(e) {
        if (e.target.closest('.delete-preview-item')) {
          var btn = e.target.closest('.delete-preview-item');
          var index = parseInt(btn.dataset.index);
          currentOrder.splice(index, 1);
          actualizarResumen();
        }
      });
      
      // Inicializar la aplicación
      renderProductos();
      actualizarResumen();
      renderSubLists();
      renderManagement();
      renderCaja();
    });
  </script>
</body>
</html>